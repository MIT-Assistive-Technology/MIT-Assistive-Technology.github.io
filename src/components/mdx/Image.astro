---
// Image component for TinaCMS rich-text editor
// This ensures proper path resolution for images inserted through TinaCMS

export interface Props {
	src: string
	alt: string
	title?: string
}

const { src, alt, title } = Astro.props

// Ensure the image path is properly formatted for Astro/MDX
// TinaCMS stores images with src/assets/images path, but we need relative path from content
let imageSrc = src

// If the path starts with /src/assets/images, convert to relative path
if (src.startsWith('/src/assets/images/')) {
	imageSrc = `../../assets/images/${src.replace('/src/assets/images/', '')}`
}

// If the path starts with src/assets/images, convert to relative path
if (src.startsWith('src/assets/images/')) {
	imageSrc = `../../assets/images/${src.replace('src/assets/images/', '')}`
}

// If it's already a relative path, use as is
if (src.startsWith('../../assets/images/')) {
	imageSrc = src
}
---

<img
	src={imageSrc}
	alt={alt}
	title={title}
	loading='lazy'
	class='w-full h-auto rounded-lg shadow-md'
/>
